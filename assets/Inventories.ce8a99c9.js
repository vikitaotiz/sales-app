import{Q as k,a as G,e as H,b as J}from"./excel.2d59e30c.js";import{b$ as K,b_ as W,r as c,aI as p,a5 as x,u as m,P as f,a3 as V,bb as o,b as X,d as a,ac as N,bV as q,bY as g,a6 as E,a4 as S}from"./index.cc8e0a4c.js";import{Q as T}from"./QInput.84e9bbf0.js";import{Q as Z,a as ee,p as te}from"./paginations.423e3bf9.js";import{Q as B}from"./QCardSection.c4d9c7a4.js";import{Q as ae,a as ne}from"./QCardActions.d38781e4.js";import{Q as re}from"./QCard.202a61f3.js";import{u as oe}from"./use-quasar.97a158a2.js";import{a as se,u as le}from"./index.aacaa6ad.js";import{g as ie,p as $}from"./module_calls.421761b7.js";import"./use-dark.9af58fdb.js";import"./QSeparator.7d727be5.js";import"./QList.17de517e.js";import"./helpers.73a7253f.js";const U=[{name:"name",required:!0,label:"Name",align:"left",field:r=>r.name,format:r=>`${r}`,sortable:!0},{name:"user",align:"center",label:"Created By",field:"user",sortable:!0},{name:"created_at",align:"center",label:"Created On",field:"created_at",sortable:!0},{name:"actions",align:"center",label:"Actions",field:"created_at"}],y=K(),i=y==null?void 0:y.token,ue=W("inventories",{state:()=>({inventories:[]}),actions:{async fetchInventories(){if(i){const r=await ie("inventories",i);return this.inventories=r==null?void 0:r.data,this.inventories}},async createInventory(r){var u;if(r.uuid=(u=y==null?void 0:y.user)==null?void 0:u.uuid,i)return await $(r,"inventories",i)},async updateInventory(r){if(i)return await $(r,"update_inventory",i)},async deleteInventory(r){if(i)return await $(r,"delete_inventory",i)}}});const de={class:"q-pa-md"},ce={key:0},me={key:1},ve={class:"text-h6"},pe={class:"text-center error_msg"},qe={__name:"Inventories",setup(r){const u=oe(),b=se(),I=ue(),w=te(10),d=c(!1),_=c(!1),Q=c(""),h=c(""),s=c(""),C=c(""),v=c(""),{data:A,isLoading:z,isError:D}=le("inventories",()=>I.fetchInventories()),L=async t=>{if(confirm(`Continue with the operation. Delete ${t.name} ?`)){const e=await I.deleteInventory({uuid:t.uuid});e.status==="success"?(b.refetchQueries("inventories"),l(e.message,"green","top")):l("There was an error","red","top-right")}},F=()=>{h.value="Add New Inventory",d.value=!0,_.value=!1},M=t=>{_.value=!0,h.value=`Edit ${t.name}`,s.value=t.name,C.value=t.uuid,d.value=!0},O=async()=>{if(v.value="",s.value.trim()){const t=await I.createInventory({name:s.value.trim()});t.status==="success"?(b.refetchQueries("inventories"),s.value="",d.value=!1,l(t.message,"green","top")):(v.value=t.message,l(t.message,"red","top-right"))}else v.value="Name is required!",l("Name is required!","red","top-right")},P=async()=>{const t={name:s.value.trim(),uuid:C.value};if(t.name){const n=await I.updateInventory(t);n.status==="success"?(b.refetchQueries("inventories"),s.value="",d.value=!1,_.value=!1,h.value="",l(n.message,"green","top")):l("There was an error","red","top-right")}else v.value="Name is required!",l("Name is required!","red","top-right")},R=()=>{d.value=!1,s.value="",C.value="",v.value=""},l=(t,n,e)=>{u.notify({message:t,color:n,position:e})},Y=t=>{const n=t.map(e=>({name:e.name,inventories:e.inventories.length,created_at:e.created_at}));H(n,U,J,u,"InventoriesData")};return(t,n)=>(p(),x("div",de,[m(z)?(p(),x("div",ce,"Loading inventories...")):m(D)?(p(),x("div",me,"An error has occurred: "+f(m(D)),1)):(p(),V(Z,{key:2,title:"Inventories",rows:m(A),columns:m(U),pagination:m(w),"onUpdate:pagination":n[2]||(n[2]=e=>X(w)?w.value=e:null),separator:"cell","row-key":"name",filter:Q.value,dense:""},{body:o(e=>[a(G,{props:e},{default:o(()=>[a(k,{key:"name",props:e},{default:o(()=>[N(f(e.row.name),1)]),_:2},1032,["props"]),a(k,{key:"user",props:e},{default:o(()=>[N(f(e.row.user),1)]),_:2},1032,["props"]),a(k,{key:"created_at",props:e},{default:o(()=>[N(f(e.row.created_at),1)]),_:2},1032,["props"]),a(k,{key:"actions",props:e},{default:o(()=>[a(q,{color:"blue",name:"edit",onClick:j=>M(e.row),style:{cursor:"pointer"},size:"20px",class:"q-mr-md"},null,8,["onClick"]),a(q,{color:"red",name:"delete",onClick:j=>L(e.row),style:{cursor:"pointer"},size:"20px"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),"top-right":o(()=>[a(T,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:Q.value,"onUpdate:modelValue":n[0]||(n[0]=e=>Q.value=e),placeholder:"Search",class:"q-mr-md"},{append:o(()=>[a(q,{name:"search"})]),_:1},8,["modelValue"]),a(g,{onClick:F,round:"",dense:"",color:"primary",size:"small",icon:"add"}),a(g,{dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:n[1]||(n[1]=e=>Y(m(A)))})]),_:1},8,["rows","columns","pagination","filter"])),a(ee,{modelValue:d.value,"onUpdate:modelValue":n[4]||(n[4]=e=>d.value=e),persistent:""},{default:o(()=>[a(re,{style:{width:"500px"}},{default:o(()=>[a(B,null,{default:o(()=>[E("div",ve,f(h.value),1)]),_:1}),a(B,{class:"q-pt-none"},{default:o(()=>[a(T,{outlined:"",dense:"",label:"Name",modelValue:s.value,"onUpdate:modelValue":n[3]||(n[3]=e=>s.value=e)},null,8,["modelValue"])]),_:1}),E("div",pe,[E("small",null,f(v.value),1)]),a(ae,{align:"right"},{default:o(()=>[a(g,{flat:"",label:"Cancel",color:"red",onClick:R}),a(ne),s.value&&!_.value?(p(),V(g,{key:0,flat:"",label:"Add Inventory",color:"primary",onClick:O})):S("",!0),s.value&&_.value?(p(),V(g,{key:1,flat:"",label:"Edit Inventory",color:"primary",onClick:P})):S("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{qe as default};
