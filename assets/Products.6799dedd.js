import{Q as u,a as Y}from"./QTr.263b02de.js";import{Q as Z}from"./QBadge.7d0f551b.js";import{r as p,j as ee,aI as _,a5 as C,u as r,P as n,a3 as x,bb as l,b as te,d as t,ac as d,a6 as k,bD as S,bE as y,a4 as B}from"./index.81829c36.js";import{Q as v}from"./QInput.8b4b83b3.js";import{Q as ae,a as oe,p as re,d as T,b as h,c as le}from"./paginations.8ce1f6e2.js";import{a as se,Q as f}from"./QCard.e2497511.js";import{Q as ne}from"./QToolbar.17c5c26f.js";import{e as ue,a as de}from"./excel.5d19a2ad.js";import{a as ie}from"./use-quasar.dff4cff8.js";import{a as me,u as Q}from"./index.56f65f5a.js";import{p as A}from"./product_columns.33f8ffe3.js";import{u as ce}from"./product-store.bc382cfe.js";import{u as pe}from"./category-store.57640066.js";import{u as _e}from"./measurement-store.656b846d.js";import{u as fe}from"./department-store.8cd82f29.js";import"./use-dark.e1850cb8.js";import"./QSeparator.282f0250.js";import"./rtl.6808dcc1.js";import"./module_calls.421761b7.js";import"./helpers.73a7253f.js";const ge={class:"q-pa-md"},ye={key:0},ve={key:1},be={class:"text-h6"},Ve={class:"text-center error_msg"},je={__name:"Products",setup(ke){const N=ie(),w=me(),b=ce(),$=pe(),M=_e(),z=fe(),P=re(10),m=p(!1),g=p(!1),q=p(""),V=p(""),D=p(""),c=p("");let o=ee({name:"",quantity:1,category_id:"",buying_price:1,selling_price:1,measurement_id:"",department_id:""});const{data:U,isLoading:I,isError:E}=Q("products",()=>b.fetchProducts()),{data:L}=Q("categories",()=>$.fetchCategories()),{data:j}=Q("measurements",()=>M.fetchMeasurements()),{data:F}=Q("departments",()=>z.fetchDepartments()),R=async s=>{if(confirm(`Continue with the operation. Delete ${s.name} ?`)){const e=await b.deleteProduct({uuid:s.uuid});e.status==="success"?(w.refetchQueries("products"),i(e.message,"green","top")):i("There was an error","red","top-right")}},G=()=>{V.value="Add New Product",m.value=!0,g.value=!1},H=s=>{console.log(s),g.value=!0,V.value=`Edit ${s.name}`,m.value=!0},J=async()=>{c.value="";const s={name:o.name.trim(),quantity:o.quantity,selling_price:o.selling_price,buying_price:o.buying_price,category_uuid:o.category_id.uuid,department_uuid:o.department_id.uuid,measurement_uuid:o.measurement_id.uuid};if(s.name&&s.selling_price&&s.buying_price){const a=await b.createProduct(s);a.status==="success"?(w.refetchQueries("products"),o.name="",o.selling_price=1,o.buying_price=1,m.value=!1,i(a.message,"green","top")):(c.value=a.message,i(a.message,"red","top-right"))}else c.value="Name, Buying and Seeling prices  is required!",i("Name is required!","red","top-right")},K=async()=>{const s={name:product_name.value.trim(),uuid:D.value};if(s.name){const a=await b.updateProduct(s);a.status==="success"?(w.refetchQueries("products"),product_name.value="",m.value=!1,g.value=!1,V.value="",i(a.message,"green","top")):i("There was an error","red","top-right")}else c.value="Name is required!",i("Name is required!","red","top-right")},O=()=>{m.value=!1,D.value="",c.value=""},i=(s,a,e)=>{N.notify({message:s,color:a,position:e})},W=s=>{const a=s.map(e=>({name:e.name,products:e.products.length,created_at:e.created_at}));ue(a,A,de,N,"ProductsData")};return(s,a)=>(_(),C("div",ge,[r(I)?(_(),C("div",ye,"Loading products...")):r(E)?(_(),C("div",ve,"An error has occurred: "+n(r(E)),1)):(_(),x(ae,{key:2,title:"Products",rows:r(U),columns:r(A),pagination:r(P),"onUpdate:pagination":a[2]||(a[2]=e=>te(P)?P.value=e:null),separator:"cell","row-key":"name",filter:q.value,dense:""},{body:l(e=>[t(Y,{props:e},{default:l(()=>[t(u,{key:"name",props:e},{default:l(()=>[d(n(e.row.name),1)]),_:2},1032,["props"]),t(u,{key:"measurement",props:e},{default:l(()=>[d(n(e.row.measurement)+" ",1),k("small",null,[t(Z,null,{default:l(()=>[d(": "+n(e.row.quantity),1)]),_:2},1024)])]),_:2},1032,["props"]),t(u,{key:"buying_price",props:e},{default:l(()=>[d(n(e.row.buying_price),1)]),_:2},1032,["props"]),t(u,{key:"selling_price",props:e},{default:l(()=>[d(n(e.row.selling_price),1)]),_:2},1032,["props"]),t(u,{key:"department",props:e},{default:l(()=>[d(n(e.row.department),1)]),_:2},1032,["props"]),t(u,{key:"category",props:e},{default:l(()=>[d(n(e.row.category),1)]),_:2},1032,["props"]),t(u,{key:"user",props:e},{default:l(()=>[d(n(e.row.user),1)]),_:2},1032,["props"]),t(u,{key:"created_at",props:e},{default:l(()=>[d(n(e.row.created_at),1)]),_:2},1032,["props"]),t(u,{key:"actions",props:e},{default:l(()=>[t(S,{color:"blue",name:"edit",onClick:X=>H(e.row),style:{cursor:"pointer"},size:"20px",class:"q-mr-md"},null,8,["onClick"]),t(S,{color:"red",name:"delete",onClick:X=>R(e.row),style:{cursor:"pointer"},size:"20px"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),"top-right":l(()=>[t(v,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:q.value,"onUpdate:modelValue":a[0]||(a[0]=e=>q.value=e),placeholder:"Search",class:"q-mr-md"},{append:l(()=>[t(S,{name:"search"})]),_:1},8,["modelValue"]),t(y,{onClick:G,round:"",dense:"",color:"primary",size:"small",icon:"add"}),t(y,{dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:a[1]||(a[1]=e=>W(r(U)))})]),_:1},8,["rows","columns","pagination","filter"])),t(oe,{modelValue:m.value,"onUpdate:modelValue":a[10]||(a[10]=e=>m.value=e),persistent:""},{default:l(()=>[t(se,{style:{width:"500px"}},{default:l(()=>[t(f,null,{default:l(()=>[k("div",be,n(V.value),1)]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(v,{outlined:"",dense:"",label:"Name",modelValue:r(o).name,"onUpdate:modelValue":a[3]||(a[3]=e=>r(o).name=e)},null,8,["modelValue"])]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(v,{outlined:"",dense:"",label:"Quantity",modelValue:r(o).quantity,"onUpdate:modelValue":a[4]||(a[4]=e=>r(o).quantity=e),type:"number"},null,8,["modelValue"])]),_:1}),t(ne,{class:"q-mb-sm"},{default:l(()=>[t(v,{outlined:"",dense:"",label:"Buying Price",modelValue:r(o).selling_price,"onUpdate:modelValue":a[5]||(a[5]=e=>r(o).selling_price=e),type:"number"},null,8,["modelValue"]),t(T),t(v,{outlined:"",dense:"",label:"Selling Price",modelValue:r(o).buying_price,"onUpdate:modelValue":a[6]||(a[6]=e=>r(o).buying_price=e),type:"number"},null,8,["modelValue"])]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(h,{dense:"",outlined:"",modelValue:r(o).category_id,"onUpdate:modelValue":a[7]||(a[7]=e=>r(o).category_id=e),options:r(L),"option-value":"uuid","option-label":"name",label:"Select Product Category"},null,8,["modelValue","options"])]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(h,{dense:"",outlined:"",modelValue:r(o).measurement_id,"onUpdate:modelValue":a[8]||(a[8]=e=>r(o).measurement_id=e),options:r(j),"option-value":"uuid","option-label":"name",label:"Select Product Measurement"},null,8,["modelValue","options"])]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(h,{dense:"",outlined:"",modelValue:r(o).department_id,"onUpdate:modelValue":a[9]||(a[9]=e=>r(o).department_id=e),options:r(F),"option-value":"uuid","option-label":"name",label:"Select Product Department"},null,8,["modelValue","options"])]),_:1}),k("div",Ve,[k("small",null,n(c.value),1)]),t(le,{align:"right"},{default:l(()=>[t(y,{flat:"",label:"Cancel",color:"red",onClick:O}),t(T),r(o).name&&!g.value?(_(),x(y,{key:0,flat:"",label:"Add Product",color:"primary",onClick:J})):B("",!0),r(o).name&&g.value?(_(),x(y,{key:1,flat:"",label:"Edit Product",color:"primary",onClick:K})):B("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{je as default};
