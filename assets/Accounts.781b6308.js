import{Q as p,a as P,e as R,b as j}from"./excel.c4e68fad.js";import{r as u,j as W,aQ as G,aI as _,a3 as A,bb as t,d as a,a5 as Q,u as r,P as s,b as H,ac as o,bV as K,c3 as v,a6 as h,a4 as S}from"./index.45153cc6.js";import{Q as w}from"./QInput.ab909322.js";import{Q as X,a as Y,p as Z,d as B,c as ee}from"./paginations.c737fe8f.js";import{Q as V}from"./QBadge.22fd821d.js";import{Q as ae}from"./QToolbar.33e7fc43.js";import{a as D,Q as T}from"./QCard.f00deb23.js";import{a as te}from"./uid.86e7d13e.js";import{a as le,u as M}from"./index.830cf3e9.js";import{u as se}from"./account-store.07fa3ed2.js";import"./use-dark.0d0b0ba9.js";import"./QSeparator.a467f888.js";import"./rtl.0b6f6848.js";import"./module_calls.421761b7.js";import"./helpers.73a7253f.js";const $=[{name:"production_cost",required:!0,label:"Expense",align:"left",field:n=>n.production_cost,format:n=>`${n}`,sortable:!0},{name:"total_sales",required:!0,label:"Expected Sales",align:"left",field:n=>n.total_sales,format:n=>`${n}`,sortable:!0},{name:"expected_cash",align:"center",label:"Expected Cash",field:"expected_cash",sortable:!0},{name:"expected_mpesa",align:"center",label:"Expected Mpesa",field:"expected_mpesa",sortable:!0},{name:"actual_cash",align:"center",label:"Actual Cash",field:"actual_cash",sortable:!0},{name:"actual_mpesa",align:"center",label:"Actual Mpesa",field:"actual_mpesa",sortable:!0},{name:"user",align:"center",label:"Created By",field:"user",sortable:!0},{name:"created_at",align:"center",label:"Created On",field:"created_at",sortable:!0}],oe={__name:"AccountsBarCharts",setup(n){const g=u([{name:"Net Profit",data:[44,55,57,56,61,58,63,60,66]},{name:"Revenue",data:[76,85,101,98,87,105,91,114,94]},{name:"Free Cash Flow",data:[35,41,36,26,45,48,52,53,41]}]),d=W({chart:{type:"bar",height:350},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",endingShape:"rounded"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:["Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct"]},yaxis:{title:{text:"$ (thousands)"}},fill:{opacity:1},tooltip:{y:{formatter:function(m){return"$ "+m+" thousands"}}}});return(m,y)=>{const b=G("apexchart");return _(),A(D,{class:"q-mb-sm"},{default:t(()=>[a(b,{type:"bar",height:"350",options:d,series:g.value},null,8,["options","series"])]),_:1})}}};const re={class:"q-pa-md"},ne={key:0},ce={key:1},ue={class:"text-h6"},de={style:{"text-align":"center"}},ie=h("i",null,"Expected Values",-1),pe=h("hr",null,null,-1),_e={class:"text-center error_msg"},Ee={__name:"Accounts",setup(n){const g=te();le();const d=se(),m=Z(10),y=u(!1),b=u(!1),C=u(""),q=u(""),f=u(1),x=u(1),U=u(""),k=u(""),{data:E,isLoading:F,isError:N}=M("accounts",()=>d.fetchAccounts());M("account_stats_today",()=>d.fetchfetchTodaySalesStats());const O=()=>{q.value="Close Accounts for the day",y.value=!0,b.value=!1},I=async()=>{k.value="";const c={actual_cash:Number(f.value),actual_mpesa:Number(x.value)};if(c.actual_cash&&c.actual_mpesa){const l=await d.createAccount(c);console.log(l)}else k.value="Name is required!",z("Name is required!","red","top-right")},L=()=>{y.value=!1,f.value=1,x.value=1,U.value="",k.value=""},z=(c,l,e)=>{g.notify({message:c,color:l,position:e})},J=c=>{const l=c.map(e=>({name:e.name,users:e.users.length,created_at:e.created_at}));R(l,$,j,g,"AccountsData")};return(c,l)=>(_(),Q("div",re,[a(oe),r(F)?(_(),Q("div",ne,"Loading accounts...")):r(N)?(_(),Q("div",ce,"An error has occurred: "+s(r(N)),1)):(_(),A(X,{key:2,title:"Accounts",rows:r(E),columns:r($),pagination:r(m),"onUpdate:pagination":l[2]||(l[2]=e=>H(m)?m.value=e:null),separator:"cell","row-key":"name",filter:C.value,dense:""},{body:t(e=>[a(P,{props:e},{default:t(()=>[a(p,{key:"production_cost",props:e},{default:t(()=>[o(s(e.row.production_cost),1)]),_:2},1032,["props"]),a(p,{key:"total_sales",props:e},{default:t(()=>[o(s(e.row.total_sales),1)]),_:2},1032,["props"]),a(p,{key:"expected_cash",props:e},{default:t(()=>[o(s(e.row.expected_cash),1)]),_:2},1032,["props"]),a(p,{key:"expected_mpesa",props:e},{default:t(()=>[o(s(e.row.expected_mpesa),1)]),_:2},1032,["props"]),a(p,{key:"actual_cash",props:e},{default:t(()=>[o(s(e.row.actual_cash),1)]),_:2},1032,["props"]),a(p,{key:"actual_mpesa",props:e},{default:t(()=>[o(s(e.row.actual_mpesa),1)]),_:2},1032,["props"]),a(p,{key:"user",props:e},{default:t(()=>[o(s(e.row.user),1)]),_:2},1032,["props"]),a(p,{key:"created_at",props:e},{default:t(()=>[o(s(e.row.created_at),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),"top-right":t(()=>[a(w,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=e=>C.value=e),placeholder:"Search",class:"q-mr-md"},{append:t(()=>[a(K,{name:"search"})]),_:1},8,["modelValue"]),a(v,{onClick:O,round:"",dense:"",color:"primary",size:"small",icon:"add"}),a(v,{dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:l[1]||(l[1]=e=>J(r(E)))})]),_:1},8,["rows","columns","pagination","filter"])),a(Y,{modelValue:y.value,"onUpdate:modelValue":l[5]||(l[5]=e=>y.value=e),persistent:""},{default:t(()=>[a(D,{style:{width:"500px"}},{default:t(()=>[a(ae,null,{default:t(()=>[h("div",ue,s(q.value),1),a(B),h("small",de,[ie,pe,a(V,{class:"q-mr-xs"},{default:t(()=>{var e,i;return[o("Total: "+s((i=(e=r(d))==null?void 0:e.today_sales_data[0])==null?void 0:i.total_daily_sales),1)]}),_:1}),a(V,{class:"q-mr-xs"},{default:t(()=>{var e,i;return[o("Cash: "+s((i=(e=r(d))==null?void 0:e.today_sales_data[1])==null?void 0:i.total_daily_cash_sales),1)]}),_:1}),a(V,{class:"q-mr-xs"},{default:t(()=>{var e,i;return[o("Mpesa: "+s((i=(e=r(d))==null?void 0:e.today_sales_data[2])==null?void 0:i.total_daily_mpesa_sales),1)]}),_:1})])]),_:1}),a(T,{class:"q-pt-none"},{default:t(()=>[a(w,{outlined:"",dense:"",label:"Actual Cash",modelValue:f.value,"onUpdate:modelValue":l[3]||(l[3]=e=>f.value=e),type:"number"},null,8,["modelValue"])]),_:1}),a(T,{class:"q-pt-none"},{default:t(()=>[a(w,{outlined:"",dense:"",label:"Actual Mpesa",modelValue:x.value,"onUpdate:modelValue":l[4]||(l[4]=e=>x.value=e),type:"number"},null,8,["modelValue"])]),_:1}),h("div",_e,[h("small",null,s(k.value),1)]),a(ee,{align:"right"},{default:t(()=>[a(v,{flat:"",label:"Cancel",color:"red",onClick:L}),a(B),f.value&&!b.value?(_(),A(v,{key:0,flat:"",label:"Close Day",color:"primary",onClick:I})):S("",!0),f.value&&b.value?(_(),A(v,{key:1,flat:"",label:"Edit Account",color:"primary",onClick:c.editSelectedAccount},null,8,["onClick"])):S("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Ee as default};
