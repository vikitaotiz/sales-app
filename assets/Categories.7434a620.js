import{Q as g,a as R,e as Y,b as j}from"./excel.2d59e30c.js";import{r as i,aI as m,a5 as w,u,P as d,a3 as x,bb as o,b as G,d as a,ac as C,bV as V,bY as f,a6 as N,a4 as D}from"./index.cc8e0a4c.js";import{Q as T}from"./QInput.84e9bbf0.js";import{Q as H,a as J,p as K}from"./paginations.423e3bf9.js";import{Q as $}from"./QCardSection.c4d9c7a4.js";import{Q as W,a as X}from"./QCardActions.d38781e4.js";import{Q as Z}from"./QCard.202a61f3.js";import{u as ee}from"./use-quasar.97a158a2.js";import{a as ae,u as te}from"./index.aacaa6ad.js";import{u as re}from"./category-store.e4820d62.js";import"./use-dark.9af58fdb.js";import"./QSeparator.7d727be5.js";import"./QList.17de517e.js";import"./module_calls.421761b7.js";import"./helpers.73a7253f.js";const B=[{name:"name",required:!0,label:"Name",align:"left",field:v=>v.name,format:v=>`${v}`,sortable:!0},{name:"products",align:"center",label:"Products",field:"products",sortable:!0},{name:"user",align:"center",label:"Created By",field:"user",sortable:!0},{name:"created_at",align:"center",label:"Created On",field:"created_at",sortable:!0},{name:"actions",align:"center",label:"Actions",field:"created_at"}];const oe={class:"q-pa-md"},se={key:0},le={key:1},ne={class:"text-h6"},ie={class:"text-center error_msg"},we={__name:"Categories",setup(v){const q=ee(),b=ae(),y=re(),k=K(10),n=i(!1),p=i(!1),Q=i(""),_=i(""),s=i(""),h=i(""),c=i(""),{data:E,isLoading:S,isError:A}=te("categories",()=>y.fetchCategories()),U=async t=>{if(confirm(`Continue with the operation. Delete ${t.name} ?`)){const e=await y.deleteCategory({uuid:t.uuid});e.status==="success"?(b.refetchQueries("categories"),l(e.message,"green","top")):l("There was an error","red","top-right")}},z=()=>{_.value="Add New Category",n.value=!0,p.value=!1},I=t=>{p.value=!0,_.value=`Edit ${t.name}`,s.value=t.name,h.value=t.uuid,n.value=!0},L=async()=>{if(c.value="",s.value.trim()){const t=await y.createCategory({name:s.value.trim()});t.status==="success"?(b.refetchQueries("categories"),s.value="",n.value=!1,l(t.message,"green","top")):(c.value=t.message,l(t.message,"red","top-right"))}else c.value="Name is required!",l("Name is required!","red","top-right")},P=async()=>{const t={name:s.value.trim(),uuid:h.value};if(t.name){const r=await y.updateCategory(t);r.status==="success"?(b.refetchQueries("categories"),s.value="",n.value=!1,p.value=!1,_.value="",l(r.message,"green","top")):l("There was an error","red","top-right")}else c.value="Name is required!",l("Name is required!","red","top-right")},F=()=>{n.value=!1,s.value="",h.value="",c.value=""},l=(t,r,e)=>{q.notify({message:t,color:r,position:e})},M=t=>{const r=t.map(e=>({name:e.name,products:e.products.length,created_at:e.created_at}));Y(r,B,j,q,"CategoriesData")};return(t,r)=>(m(),w("div",oe,[u(S)?(m(),w("div",se,"Loading categories...")):u(A)?(m(),w("div",le,"An error has occurred: "+d(u(A)),1)):(m(),x(H,{key:2,title:"Categories",rows:u(E),columns:u(B),pagination:u(k),"onUpdate:pagination":r[2]||(r[2]=e=>G(k)?k.value=e:null),separator:"cell","row-key":"name",filter:Q.value,dense:""},{body:o(e=>[a(R,{props:e},{default:o(()=>[a(g,{key:"name",props:e},{default:o(()=>[C(d(e.row.name),1)]),_:2},1032,["props"]),a(g,{key:"products",props:e},{default:o(()=>[C(d(e.row.products.length),1)]),_:2},1032,["props"]),a(g,{key:"user",props:e},{default:o(()=>[C(d(e.row.user),1)]),_:2},1032,["props"]),a(g,{key:"created_at",props:e},{default:o(()=>[C(d(e.row.created_at),1)]),_:2},1032,["props"]),a(g,{key:"actions",props:e},{default:o(()=>[a(V,{color:"blue",name:"edit",onClick:O=>I(e.row),style:{cursor:"pointer"},size:"20px",class:"q-mr-md"},null,8,["onClick"]),a(V,{color:"red",name:"delete",onClick:O=>U(e.row),style:{cursor:"pointer"},size:"20px"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),"top-right":o(()=>[a(T,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:Q.value,"onUpdate:modelValue":r[0]||(r[0]=e=>Q.value=e),placeholder:"Search",class:"q-mr-md"},{append:o(()=>[a(V,{name:"search"})]),_:1},8,["modelValue"]),a(f,{onClick:z,round:"",dense:"",color:"primary",size:"small",icon:"add"}),a(f,{dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:r[1]||(r[1]=e=>M(u(E)))})]),_:1},8,["rows","columns","pagination","filter"])),a(J,{modelValue:n.value,"onUpdate:modelValue":r[4]||(r[4]=e=>n.value=e),persistent:""},{default:o(()=>[a(Z,{style:{width:"500px"}},{default:o(()=>[a($,null,{default:o(()=>[N("div",ne,d(_.value),1)]),_:1}),a($,{class:"q-pt-none"},{default:o(()=>[a(T,{outlined:"",dense:"",label:"Name",modelValue:s.value,"onUpdate:modelValue":r[3]||(r[3]=e=>s.value=e)},null,8,["modelValue"])]),_:1}),N("div",ie,[N("small",null,d(c.value),1)]),a(W,{align:"right"},{default:o(()=>[a(f,{flat:"",label:"Cancel",color:"red",onClick:F}),a(X),s.value&&!p.value?(m(),x(f,{key:0,flat:"",label:"Add Category",color:"primary",onClick:L})):D("",!0),s.value&&p.value?(m(),x(f,{key:1,flat:"",label:"Edit Category",color:"primary",onClick:P})):D("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{we as default};
