import{Q as y,a as R}from"./QTr.263b02de.js";import{r as i,aI as m,a5 as Q,u,P as c,a3 as w,bb as s,b as j,d as t,ac as C,bD as x,bE as f,a6 as N,a4 as A}from"./index.81829c36.js";import{Q as T}from"./QInput.8b4b83b3.js";import{Q as G,a as H,p as J,c as K,d as W}from"./paginations.8ce1f6e2.js";import{a as X,Q as $}from"./QCard.e2497511.js";import{e as Y,a as Z}from"./excel.5d19a2ad.js";import{a as ee}from"./use-quasar.dff4cff8.js";import{a as ae,u as te}from"./index.56f65f5a.js";import{u as re}from"./department-store.8cd82f29.js";import"./use-dark.e1850cb8.js";import"./QSeparator.282f0250.js";import"./rtl.6808dcc1.js";import"./module_calls.421761b7.js";import"./helpers.73a7253f.js";const S=[{name:"name",required:!0,label:"Name",align:"left",field:v=>v.name,format:v=>`${v}`,sortable:!0},{name:"users",align:"center",label:"Users",field:"users",sortable:!0},{name:"created_at",align:"center",label:"Created On",field:"created_at",sortable:!0},{name:"actions",align:"center",label:"Actions",field:"created_at"}];const se={class:"q-pa-md"},le={key:0},oe={key:1},ne={class:"text-h6"},ie={class:"text-center error_msg"},Qe={__name:"Departments",setup(v){const V=ee(),D=ae(),_=re(),b=J(10),n=i(!1),p=i(!1),h=i(""),g=i(""),l=i(""),k=i(""),d=i(""),{data:q,isLoading:U,isError:E}=te("departments",()=>_.fetchDepartments()),B=async a=>{if(confirm(`Continue with the operation. Delete ${a.name} ?`)){const e=await _.deleteDepartment({uuid:a.uuid});e.status==="success"?(D.refetchQueries("departments"),o(e.message,"green","top")):o("There was an error","red","top-right")}},z=()=>{g.value="Add New Department",n.value=!0,p.value=!1},I=a=>{p.value=!0,g.value=`Edit ${a.name}`,l.value=a.name,k.value=a.uuid,n.value=!0},L=async()=>{if(d.value="",l.value.trim()){const a=await _.createDepartment({name:l.value.trim()});a.status==="success"?(D.refetchQueries("departments"),l.value="",n.value=!1,o(a.message,"green","top")):(d.value=a.message,o(a.message,"red","top-right"))}else d.value="Name is required!",o("Name is required!","red","top-right")},F=async()=>{const a={name:l.value.trim(),uuid:k.value};if(a.name){const r=await _.updateDepartment(a);r.status==="success"?(D.refetchQueries("departments"),l.value="",n.value=!1,p.value=!1,g.value="",o(r.message,"green","top")):o("There was an error","red","top-right")}else d.value="Name is required!",o("Name is required!","red","top-right")},M=()=>{n.value=!1,l.value="",k.value="",d.value=""},o=(a,r,e)=>{V.notify({message:a,color:r,position:e})},O=a=>{const r=a.map(e=>({name:e.name,users:e.users.length,created_at:e.created_at}));Y(r,S,Z,V,"DepartmentsData")};return(a,r)=>(m(),Q("div",se,[u(U)?(m(),Q("div",le,"Loading departments...")):u(E)?(m(),Q("div",oe,"An error has occurred: "+c(u(E)),1)):(m(),w(G,{key:2,title:"Departments",rows:u(q),columns:u(S),pagination:u(b),"onUpdate:pagination":r[2]||(r[2]=e=>j(b)?b.value=e:null),separator:"cell","row-key":"name",filter:h.value,dense:""},{body:s(e=>[t(R,{props:e},{default:s(()=>[t(y,{key:"name",props:e},{default:s(()=>[C(c(e.row.name),1)]),_:2},1032,["props"]),t(y,{key:"users",props:e},{default:s(()=>[C(c(e.row.users.length),1)]),_:2},1032,["props"]),t(y,{key:"created_at",props:e},{default:s(()=>[C(c(e.row.created_at),1)]),_:2},1032,["props"]),t(y,{key:"actions",props:e},{default:s(()=>[t(x,{color:"blue",name:"edit",onClick:P=>I(e.row),style:{cursor:"pointer"},size:"20px",class:"q-mr-md"},null,8,["onClick"]),t(x,{color:"red",name:"delete",onClick:P=>B(e.row),style:{cursor:"pointer"},size:"20px"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),"top-right":s(()=>[t(T,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:h.value,"onUpdate:modelValue":r[0]||(r[0]=e=>h.value=e),placeholder:"Search",class:"q-mr-md"},{append:s(()=>[t(x,{name:"search"})]),_:1},8,["modelValue"]),t(f,{onClick:z,round:"",dense:"",color:"primary",size:"small",icon:"add"}),t(f,{dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:r[1]||(r[1]=e=>O(u(q)))})]),_:1},8,["rows","columns","pagination","filter"])),t(H,{modelValue:n.value,"onUpdate:modelValue":r[4]||(r[4]=e=>n.value=e),persistent:""},{default:s(()=>[t(X,{style:{width:"500px"}},{default:s(()=>[t($,null,{default:s(()=>[N("div",ne,c(g.value),1)]),_:1}),t($,{class:"q-pt-none"},{default:s(()=>[t(T,{outlined:"",dense:"",label:"Name",modelValue:l.value,"onUpdate:modelValue":r[3]||(r[3]=e=>l.value=e)},null,8,["modelValue"])]),_:1}),N("div",ie,[N("small",null,c(d.value),1)]),t(K,{align:"right"},{default:s(()=>[t(f,{flat:"",label:"Cancel",color:"red",onClick:M}),t(W),l.value&&!p.value?(m(),w(f,{key:0,flat:"",label:"Add Department",color:"primary",onClick:L})):A("",!0),l.value&&p.value?(m(),w(f,{key:1,flat:"",label:"Edit Department",color:"primary",onClick:F})):A("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Qe as default};
