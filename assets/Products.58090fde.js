import{Q as f,a as R,e as Y,b as j}from"./excel.2d59e30c.js";import{r as d,aI as m,a5 as P,u as n,P as i,a3 as C,bb as r,b as G,d as t,ac as y,bV as b,bY as v,a6 as x,a4 as E}from"./index.cc8e0a4c.js";import{Q as D}from"./QInput.84e9bbf0.js";import{Q as H,a as J,p as K}from"./paginations.423e3bf9.js";import{Q as T}from"./QCardSection.c4d9c7a4.js";import{Q as O,a as W}from"./QCardActions.d38781e4.js";import{Q as X}from"./QCard.202a61f3.js";import{u as Z}from"./use-quasar.97a158a2.js";import{a as ee,u as te}from"./index.aacaa6ad.js";import{u as ae,p as A}from"./product-store.2311c6ab.js";import"./use-dark.9af58fdb.js";import"./QSeparator.7d727be5.js";import"./QList.17de517e.js";import"./module_calls.421761b7.js";import"./helpers.73a7253f.js";const oe={class:"q-pa-md"},re={key:0},se={key:1},le={class:"text-h6"},ue={class:"text-center error_msg"},Ce={__name:"Products",setup(de){const V=Z(),k=ee(),_=ae(),Q=K(10),u=d(!1),p=d(!1),h=d(""),g=d(""),s=d(""),w=d(""),c=d(""),{data:N,isLoading:S,isError:q}=te("products",()=>_.fetchProducts()),$=async a=>{if(confirm(`Continue with the operation. Delete ${a.name} ?`)){const e=await _.deleteProduct({uuid:a.uuid});e.status==="success"?(k.refetchQueries("products"),l(e.message,"green","top")):l("There was an error","red","top-right")}},B=()=>{g.value="Add New Product",u.value=!0,p.value=!1},U=a=>{p.value=!0,g.value=`Edit ${a.name}`,s.value=a.name,w.value=a.uuid,u.value=!0},z=async()=>{if(c.value="",s.value.trim()){const a=await _.createProduct({name:s.value.trim()});a.status==="success"?(k.refetchQueries("products"),s.value="",u.value=!1,l(a.message,"green","top")):(c.value=a.message,l(a.message,"red","top-right"))}else c.value="Name is required!",l("Name is required!","red","top-right")},I=async()=>{const a={name:s.value.trim(),uuid:w.value};if(a.name){const o=await _.updateProduct(a);o.status==="success"?(k.refetchQueries("products"),s.value="",u.value=!1,p.value=!1,g.value="",l(o.message,"green","top")):l("There was an error","red","top-right")}else c.value="Name is required!",l("Name is required!","red","top-right")},L=()=>{u.value=!1,s.value="",w.value="",c.value=""},l=(a,o,e)=>{V.notify({message:a,color:o,position:e})},F=a=>{const o=a.map(e=>({name:e.name,products:e.products.length,created_at:e.created_at}));Y(o,A,j,V,"ProductsData")};return(a,o)=>(m(),P("div",oe,[n(S)?(m(),P("div",re,"Loading products...")):n(q)?(m(),P("div",se,"An error has occurred: "+i(n(q)),1)):(m(),C(H,{key:2,title:"Products",rows:n(N),columns:n(A),pagination:n(Q),"onUpdate:pagination":o[2]||(o[2]=e=>G(Q)?Q.value=e:null),separator:"cell","row-key":"name",filter:h.value,dense:""},{body:r(e=>[t(R,{props:e},{default:r(()=>[t(f,{key:"name",props:e},{default:r(()=>[y(i(e.row.name),1)]),_:2},1032,["props"]),t(f,{key:"category",props:e},{default:r(()=>[y(i(e.row.category),1)]),_:2},1032,["props"]),t(f,{key:"user",props:e},{default:r(()=>[y(i(e.row.user),1)]),_:2},1032,["props"]),t(f,{key:"created_at",props:e},{default:r(()=>[y(i(e.row.created_at),1)]),_:2},1032,["props"]),t(f,{key:"actions",props:e},{default:r(()=>[t(b,{color:"blue",name:"edit",onClick:M=>U(e.row),style:{cursor:"pointer"},size:"20px",class:"q-mr-md"},null,8,["onClick"]),t(b,{color:"red",name:"delete",onClick:M=>$(e.row),style:{cursor:"pointer"},size:"20px"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),"top-right":r(()=>[t(D,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:h.value,"onUpdate:modelValue":o[0]||(o[0]=e=>h.value=e),placeholder:"Search",class:"q-mr-md"},{append:r(()=>[t(b,{name:"search"})]),_:1},8,["modelValue"]),t(v,{onClick:B,round:"",dense:"",color:"primary",size:"small",icon:"add"}),t(v,{dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:o[1]||(o[1]=e=>F(n(N)))})]),_:1},8,["rows","columns","pagination","filter"])),t(J,{modelValue:u.value,"onUpdate:modelValue":o[4]||(o[4]=e=>u.value=e),persistent:""},{default:r(()=>[t(X,{style:{width:"500px"}},{default:r(()=>[t(T,null,{default:r(()=>[x("div",le,i(g.value),1)]),_:1}),t(T,{class:"q-pt-none"},{default:r(()=>[t(D,{outlined:"",dense:"",label:"Name",modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=e=>s.value=e)},null,8,["modelValue"])]),_:1}),x("div",ue,[x("small",null,i(c.value),1)]),t(O,{align:"right"},{default:r(()=>[t(v,{flat:"",label:"Cancel",color:"red",onClick:L}),t(W),s.value&&!p.value?(m(),C(v,{key:0,flat:"",label:"Add Product",color:"primary",onClick:z})):E("",!0),s.value&&p.value?(m(),C(v,{key:1,flat:"",label:"Edit Product",color:"primary",onClick:I})):E("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Ce as default};
